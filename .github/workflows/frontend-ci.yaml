name: frontendWorkflow1

# Ensure the workflow runs on schedule (Sunday at 0:00) and on push to the main branch
on:
  workflow_dispatch:
    paths:
      -'frontend/**'
    branches:       
      - main
        
  pull_request:
    paths:
      -'frontend/**'  
    branches: 
      - main

#Use a matrix strategy to use Node.js versions 16.x and 18.x
jobs:
  LINT:

    runs-on: ubuntu-latest
    steps:
      # Check out the code from the repository.
      - uses: actions/checkout@v3

      # Set up a Node.js environment using the specified node version.
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: Latest

      - name: Cache dependencies
      - uses: actions/cache@v4
        with:
        path: ~/ .npm
        key: key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
          restore-keys: |
            ${{ runner.os }}-node-
 
      # Install the dependencies.
      - run: cd frontend && npm ci

      # Run the tests.
      - run: cd frontend && npm test

      # Run the linter.
      - run: cd frontend && npm run lint
---
 TEST:
    runs-on: ubuntu-latest
    steps:
      # Check out the code from the repository.
      - uses: actions/checkout@v3

      # Set up a Node.js environment using the specified node version.
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: Latest

      - name: Cache dependencies
      - uses: actions/cache@v4
        with:
        path: ~/ .npm
        key: key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
          restore-keys: |
            ${{ runner.os }}-node-
 
      # Install the dependencies.
      - run: cd frontend && npm ci

      # Run the tests.
      - run: cd frontend && npm run test

  BUILD:
    needs: [LINT, TEST]
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: Latest

      - name: Cache dependencies
      - uses: actions/cache@v4
        with:
        path: ~/ .npm
        key: key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
          restore-keys: |
            ${{ runner.os }}-node- 
      - run: cd frontend && npm ci
      - run: cd frontend && npm run test  
      - run: docker build -t Dockerfile      

        